---
layout: default
title: "Public Funds Tracker - Solano County Municipal Budget Transparency"
description: "Track public spending across Solano County's 7 cities: Fairfield, Vallejo, Vacaville, Suisun City, Benicia, Dixon, Rio Vista. Municipal budgets, impact fees, and government financial transparency."
permalink: /public-funds/
---

<main class="isolate pt-28">
  <!-- Hero section -->
  <div class="relative isolate -z-10 overflow-hidden bg-gradient-to-b from-green-100/20 pt-14">
  </div>

  <!-- Main content -->
  <section class="mx-auto max-w-7xl px-6 lg:px-8">
    <!-- Header and Mission - 2 columns on desktop -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
      <!-- Title Column -->
      <div>
        <div class="flex items-center gap-4 mb-6">
          <div class="flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-green-500 to-green-600 text-white text-3xl shadow-lg">
            ğŸ’°
          </div>
          <div>
            <h1 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">Public Funds Tracker</h1>
            <p class="mt-2 text-lg leading-8 text-gray-600">Following every penny through Solano County public agencies</p>
          </div>
        </div>
      </div>

      <!-- Mission Column -->
      <div>
        <div class="bg-white rounded-xl border border-gray-200 p-5">
          <h2 class="text-xl font-bold text-gray-900 mb-3">Our Mission</h2>
          <p class="text-base text-gray-700 mb-4 leading-relaxed">
            Every public dollar spent in Solano County should be trackable, transparent, and accountable to the people it serves.
          </p>
          <div class="bg-green-50 border border-green-200 rounded-lg p-4">
            <h3 class="text-base font-semibold text-green-900 mb-3">What We Track</h3>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-2 text-sm text-green-800">
              <div class="flex items-start gap-2">
                <span class="text-green-600 mt-0.5 text-xs">âœ“</span>
                <span>Municipal budgets & expenditures</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-green-600 mt-0.5 text-xs">âœ“</span>
                <span>County government spending</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-green-600 mt-0.5 text-xs">âœ“</span>
                <span>Special district finances</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-green-600 mt-0.5 text-xs">âœ“</span>
                <span>School district budgets</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-green-600 mt-0.5 text-xs">âœ“</span>
                <span>Development & impact fees</span>
              </div>
              <div class="flex items-start gap-2">
                <span class="text-green-600 mt-0.5 text-xs">âœ“</span>
                <span>Grant & program funding</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Current Status -->
    <div class="grid gap-8 sm:grid-cols-1 lg:grid-cols-2 mb-16">
      <!-- In Progress -->
      <div class="bg-yellow-50 border border-yellow-200 rounded-2xl p-8">
        <div class="flex items-center gap-3 mb-6">
          <span class="text-2xl">ğŸš§</span>
          <h3 class="text-xl font-bold text-yellow-900">Currently Building</h3>
        </div>
        <p class="text-yellow-800 mb-6">
          We're actively working to compile comprehensive financial data across Solano County's public agencies.
          This is a complex undertaking that requires systematic collection and verification of data from multiple sources.
        </p>
        <div class="space-y-4">
          <div class="bg-white border border-yellow-200 rounded-lg p-4">
            <h4 class="font-semibold text-yellow-900 mb-2">Phase 1: Data Collection</h4>
            <p class="text-sm text-yellow-800">
              Gathering budget documents, financial reports, and expenditure records from all jurisdictions
            </p>
            <div class="mt-3 bg-yellow-200 rounded-full h-2">
              <div class="bg-yellow-500 h-2 rounded-full w-3/4"></div>
            </div>
            <p class="text-xs text-yellow-700 mt-1">75% Complete</p>
          </div>
          <div class="bg-white border border-yellow-200 rounded-lg p-4">
            <h4 class="font-semibold text-yellow-900 mb-2">Phase 2: Data Standardization</h4>
            <p class="text-sm text-yellow-800">
              Converting different formats into comparable, searchable data
            </p>
            <div class="mt-3 bg-yellow-200 rounded-full h-2">
              <div class="bg-yellow-500 h-2 rounded-full w-1/2"></div>
            </div>
            <p class="text-xs text-yellow-700 mt-1">50% Complete</p>
          </div>
          <div class="bg-white border border-yellow-200 rounded-lg p-4">
            <h4 class="font-semibold text-yellow-900 mb-2">Phase 3: Visualization Tools</h4>
            <p class="text-sm text-yellow-800">
              Building interactive charts and search tools for public use
            </p>
            <div class="mt-3 bg-yellow-200 rounded-full h-2">
              <div class="bg-yellow-500 h-2 rounded-full w-1/4"></div>
            </div>
            <p class="text-xs text-yellow-700 mt-1">25% Complete</p>
          </div>
        </div>
      </div>

      <!-- Early Insights -->
      <div class="bg-blue-50 border border-blue-200 rounded-2xl p-8">
        <div class="flex items-center gap-3 mb-6">
          <span class="text-2xl">ğŸ“Š</span>
          <h3 class="text-xl font-bold text-blue-900">Early Insights</h3>
        </div>
        <p class="text-blue-800 mb-6">
          Even with preliminary data, we're already uncovering important patterns in how public money flows through Solano County.
        </p>
        <div class="space-y-4">
          <div class="bg-white border border-blue-200 rounded-lg p-4">
            <h4 class="font-semibold text-blue-900 mb-2">Budget Transparency Varies</h4>
            <p class="text-sm text-blue-800">
              Some cities provide detailed, accessible budget documents while others offer minimal public information
            </p>
          </div>
          <div class="bg-white border border-blue-200 rounded-lg p-4">
            <h4 class="font-semibold text-blue-900 mb-2">Special Districts Add Complexity</h4>
            <p class="text-sm text-blue-800">
              Multiple overlapping districts create layers of taxation and spending that are difficult to track
            </p>
          </div>
          <div class="bg-white border border-blue-200 rounded-lg p-4">
            <h4 class="font-semibold text-blue-900 mb-2">Development Fees Vary Widely</h4>
            <p class="text-sm text-blue-800">
              Similar development projects face dramatically different fee structures across jurisdictions
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- How to Participate -->
    <div class="bg-indigo-50 border border-indigo-200 rounded-2xl p-8 mb-16">
      <div class="flex items-center gap-3 mb-8">
        <span class="text-3xl">ğŸ¤</span>
        <h2 class="text-2xl font-bold text-indigo-900">How You Can Participate</h2>
      </div>
      <p class="text-lg text-indigo-800 mb-8">
        This effort requires community involvement. Public financial transparency works best when citizens are engaged
        and holding their governments accountable.
      </p>

      <div class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
        <!-- Submit Documents -->
        <div class="bg-white border border-indigo-200 rounded-xl p-6">
          <div class="text-2xl mb-4">ğŸ“„</div>
          <h3 class="text-lg font-bold text-indigo-900 mb-3">Submit Documents</h3>
          <p class="text-indigo-800 mb-4">
            Have access to budget documents, financial reports, or spending records? Share them with us.
          </p>
          <a href="mailto:info@opensolano.org?subject=Public%20Funds%20Document"
             class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-700">
            Send Documents
            <span class="ml-2">â†’</span>
          </a>
        </div>

        <!-- Attend Meetings -->
        <div class="bg-white border border-indigo-200 rounded-xl p-6">
          <div class="text-2xl mb-4">ğŸ‘¥</div>
          <h3 class="text-lg font-bold text-indigo-900 mb-3">Attend Budget Meetings</h3>
          <p class="text-indigo-800 mb-4">
            Public budget hearings and city council meetings provide opportunities to ask questions and request information.
          </p>
          <a href="/topics/#meetings"
             class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-700">
            Find Meetings
            <span class="ml-2">â†’</span>
          </a>
        </div>

        <!-- FOIA Requests -->
        <div class="bg-white border border-indigo-200 rounded-xl p-6">
          <div class="text-2xl mb-4">ğŸ“‹</div>
          <h3 class="text-lg font-bold text-indigo-900 mb-3">File Public Records Requests</h3>
          <p class="text-indigo-800 mb-4">
            The California Public Records Act gives you the right to access government financial information.
          </p>
          <a href="mailto:info@opensolano.org?subject=FOIA%20Request%20Help"
             class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-700">
            Get Help
            <span class="ml-2">â†’</span>
          </a>
        </div>

        <!-- Volunteer -->
        <div class="bg-white border border-indigo-200 rounded-xl p-6">
          <div class="text-2xl mb-4">ğŸ™‹â€â™€ï¸</div>
          <h3 class="text-lg font-bold text-indigo-900 mb-3">Volunteer Research</h3>
          <p class="text-indigo-800 mb-4">
            Help us collect, organize, and analyze financial data from across the county.
          </p>
          <a href="mailto:volunteer@opensolano.org?subject=Public%20Funds%20Research%20Volunteer"
             class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-700">
            Volunteer
            <span class="ml-2">â†’</span>
          </a>
        </div>

        <!-- Spread Awareness -->
        <div class="bg-white border border-indigo-200 rounded-xl p-6">
          <div class="text-2xl mb-4">ğŸ“¢</div>
          <h3 class="text-lg font-bold text-indigo-900 mb-3">Spread Awareness</h3>
          <p class="text-indigo-800 mb-4">
            Share our work with neighbors, community groups, and local organizations who care about transparency.
          </p>
          <a href="mailto:?subject=Solano County Public Funds Tracker&body=Check out this effort to track public spending in Solano County: {{ site.url }}/public-funds/"
             class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-700">
            Share
            <span class="ml-2">â†’</span>
          </a>
        </div>

        <!-- Ask Questions -->
        <div class="bg-white border border-indigo-200 rounded-xl p-6">
          <div class="text-2xl mb-4">â“</div>
          <h3 class="text-lg font-bold text-indigo-900 mb-3">Ask Questions</h3>
          <p class="text-indigo-800 mb-4">
            Contact us with specific questions about public spending that you'd like us to investigate.
          </p>
          <a href="mailto:questions@opensolano.org?subject=Public%20Spending%20Question"
             class="inline-flex items-center text-sm font-medium text-indigo-600 hover:text-indigo-700">
            Ask Away
            <span class="ml-2">â†’</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Budget Overview Chart -->
    <div class="bg-white border border-gray-200 rounded-2xl p-8 mb-16">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Solano County Budget Overview</h2>
      <p class="text-gray-600 mb-8">
        Revenue and expenditure trends across the past decade.
      </p>
      
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-8">
        <div class="flex items-center gap-2">
          <span class="text-yellow-600">âš ï¸</span>
          <p class="text-sm text-yellow-800 font-medium">Note: This chart uses representative stub data for demonstration purposes. Actual budget data is being compiled from multiple sources.</p>
        </div>
      </div>

      <div id="budget-chart" class="w-full"></div>
    </div>

    <!-- Cost Per Citizen Metrics -->
    <div class="bg-white border border-gray-200 rounded-2xl p-8 mb-16">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Cost Per Citizen</h2>
      <p class="text-gray-600 mb-8">
        Annual per-capita spending on key public services across Solano County.
      </p>
      
      <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-8">
        <div class="flex items-center gap-2">
          <span class="text-yellow-600">âš ï¸</span>
          <p class="text-sm text-yellow-800 font-medium">Note: These are estimated figures based on available budget documents. Actual costs may vary by jurisdiction.</p>
        </div>
      </div>

      <div class="overflow-x-auto">
        <table class="w-full border-collapse">
          <thead>
            <tr class="border-b-2 border-gray-200">
              <th class="text-left py-4 px-4 font-semibold text-gray-900">Service Category</th>
              <th class="text-right py-4 px-4 font-semibold text-gray-900">Annual Cost per Citizen</th>
              <th class="text-right py-4 px-4 font-semibold text-gray-900">Monthly Cost</th>
              <th class="text-left py-4 px-4 font-semibold text-gray-600 text-sm">Notes</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-100">
            <tr class="hover:bg-gray-50">
              <td class="py-4 px-4">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">ğŸ“</span>
                  <div>
                    <div class="font-medium text-gray-900">Public Education</div>
                    <div class="text-sm text-gray-600">K-12 schools, community colleges</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-4 text-right font-semibold text-green-600">$2,340</td>
              <td class="py-4 px-4 text-right text-gray-600">$195</td>
              <td class="py-4 px-4 text-sm text-gray-500">Largest single expense</td>
            </tr>
            <tr class="hover:bg-gray-50">
              <td class="py-4 px-4">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">ğŸš¨</span>
                  <div>
                    <div class="font-medium text-gray-900">Public Safety</div>
                    <div class="text-sm text-gray-600">Police, sheriff, courts</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-4 text-right font-semibold text-blue-600">$890</td>
              <td class="py-4 px-4 text-right text-gray-600">$74</td>
              <td class="py-4 px-4 text-sm text-gray-500">Varies by city</td>
            </tr>
            <tr class="hover:bg-gray-50">
              <td class="py-4 px-4">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">ğŸš’</span>
                  <div>
                    <div class="font-medium text-gray-900">Fire Protection</div>
                    <div class="text-sm text-gray-600">Fire departments, emergency services</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-4 text-right font-semibold text-red-600">$420</td>
              <td class="py-4 px-4 text-right text-gray-600">$35</td>
              <td class="py-4 px-4 text-sm text-gray-500">Mostly special districts</td>
            </tr>
            <tr class="hover:bg-gray-50">
              <td class="py-4 px-4">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">ğŸ¥</span>
                  <div>
                    <div class="font-medium text-gray-900">Health & Social Services</div>
                    <div class="text-sm text-gray-600">Public health, social services</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-4 text-right font-semibold text-purple-600">$680</td>
              <td class="py-4 px-4 text-right text-gray-600">$57</td>
              <td class="py-4 px-4 text-sm text-gray-500">County-administered</td>
            </tr>
            <tr class="hover:bg-gray-50">
              <td class="py-4 px-4">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">ğŸ—ï¸</span>
                  <div>
                    <div class="font-medium text-gray-900">Infrastructure</div>
                    <div class="text-sm text-gray-600">Roads, bridges, public works</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-4 text-right font-semibold text-orange-600">$320</td>
              <td class="py-4 px-4 text-right text-gray-600">$27</td>
              <td class="py-4 px-4 text-sm text-gray-500">Maintenance & capital</td>
            </tr>
            <tr class="hover:bg-gray-50">
              <td class="py-4 px-4">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">ğŸ—‘ï¸</span>
                  <div>
                    <div class="font-medium text-gray-900">Waste Management</div>
                    <div class="text-sm text-gray-600">Garbage, recycling, landfills</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-4 text-right font-semibold text-green-700">$180</td>
              <td class="py-4 px-4 text-right text-gray-600">$15</td>
              <td class="py-4 px-4 text-sm text-gray-500">Often fee-based</td>
            </tr>
            <tr class="hover:bg-gray-50">
              <td class="py-4 px-4">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">ğŸ’§</span>
                  <div>
                    <div class="font-medium text-gray-900">Water Services</div>
                    <div class="text-sm text-gray-600">Water supply, treatment, distribution</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-4 text-right font-semibold text-blue-700">$290</td>
              <td class="py-4 px-4 text-right text-gray-600">$24</td>
              <td class="py-4 px-4 text-sm text-gray-500">Multiple districts</td>
            </tr>
            <tr class="hover:bg-gray-50">
              <td class="py-4 px-4">
                <div class="flex items-center gap-3">
                  <span class="text-2xl">âš¡</span>
                  <div>
                    <div class="font-medium text-gray-900">Utilities</div>
                    <div class="text-sm text-gray-600">Public power, street lighting</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-4 text-right font-semibold text-yellow-600">$150</td>
              <td class="py-4 px-4 text-right text-gray-600">$13</td>
              <td class="py-4 px-4 text-sm text-gray-500">Limited public provision</td>
            </tr>
          </tbody>
          <tfoot class="border-t-2 border-gray-300">
            <tr class="bg-gray-50 font-semibold">
              <td class="py-4 px-4 text-gray-900">Total Annual Cost</td>
              <td class="py-4 px-4 text-right text-gray-900">$5,270</td>
              <td class="py-4 px-4 text-right text-gray-900">$439</td>
              <td class="py-4 px-4 text-sm text-gray-600">Per citizen estimate</td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>

    <!-- Related Analysis -->
    <div class="bg-white border border-gray-200 rounded-2xl p-8">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Related Analysis</h2>
      <p class="text-gray-600 mb-8">
        Explore our existing research on public finances and government spending in Solano County.
      </p>

      <!-- Links to related topics -->
      <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
        <a href="/topics/#budgets" class="group flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:border-indigo-300 hover:shadow-sm transition-all">
          <span class="text-2xl">ğŸ’°</span>
          <div>
            <h3 class="font-semibold text-gray-900 group-hover:text-indigo-600 transition-colors">Municipal Budgets</h3>
            <p class="text-sm text-gray-600">City budget analysis and transparency</p>
          </div>
        </a>
        
        <a href="/topics/#impact-fees" class="group flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:border-indigo-300 hover:shadow-sm transition-all">
          <span class="text-2xl">ğŸ’µ</span>
          <div>
            <h3 class="font-semibold text-gray-900 group-hover:text-indigo-600 transition-colors">Impact Fees</h3>
            <p class="text-sm text-gray-600">Development impact fees and assessments</p>
          </div>
        </a>
        
        <a href="/topics/#infrastructure" class="group flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:border-indigo-300 hover:shadow-sm transition-all">
          <span class="text-2xl">ğŸ—ï¸</span>
          <div>
            <h3 class="font-semibold text-gray-900 group-hover:text-indigo-600 transition-colors">Infrastructure</h3>
            <p class="text-sm text-gray-600">Public works and infrastructure funding</p>
          </div>
        </a>
      </div>
    </div>

    <!-- Footer CTA -->
    <div class="mt-16 text-center">
      <div class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl p-8 text-white">
        <h2 class="text-2xl font-bold mb-4">Stay Informed</h2>
        <p class="text-indigo-100 mb-6">
          Get updates as we publish new financial analysis and transparency tools.
        </p>
        <a href="mailto:updates@opensolano.org?subject=Public%20Funds%20Updates"
           class="inline-flex items-center bg-white text-indigo-600 font-semibold px-6 py-3 rounded-lg hover:bg-gray-50 transition-colors">
          Subscribe to Updates
          <span class="ml-2">â†’</span>
        </a>
      </div>
    </div>
  </section>
</main>

<script src="https://d3js.org/d3.v7.min.js"></script>
<script>
// Stub data for Solano County budget (10 years)
const budgetData = [
  { year: 2014, revenue: 280, expenses: 275, population: 425000 },
  { year: 2015, revenue: 295, expenses: 290, population: 430000 },
  { year: 2016, revenue: 310, expenses: 305, population: 435000 },
  { year: 2017, revenue: 325, expenses: 320, population: 440000 },
  { year: 2018, revenue: 340, expenses: 335, population: 445000 },
  { year: 2019, revenue: 355, expenses: 350, population: 450000 },
  { year: 2020, revenue: 330, expenses: 365, population: 455000 }, // COVID impact
  { year: 2021, revenue: 345, expenses: 370, population: 460000 },
  { year: 2022, revenue: 380, expenses: 375, population: 465000 },
  { year: 2023, revenue: 395, expenses: 390, population: 470000 }
];

let svg, xScale, yScale, width, height, legend;

function createChart() {
  // Clear any existing chart
  d3.select('#budget-chart').selectAll('*').remove();
  
  // Get container dimensions
  const container = d3.select('#budget-chart');
  const containerWidth = container.node().getBoundingClientRect().width;
  
  // Chart dimensions - responsive
  const margin = { 
    top: 20, 
    right: window.innerWidth > 768 ? 80 : 40, 
    bottom: 60, 
    left: window.innerWidth > 768 ? 80 : 60 
  };
  
  width = Math.max(300, containerWidth - margin.left - margin.right);
  height = Math.max(250, Math.min(500, width * 0.6));

  // Create SVG
  svg = d3.select('#budget-chart')
    .append('svg')
    .attr('width', '100%')
    .attr('height', height + margin.top + margin.bottom)
    .attr('viewBox', `0 0 ${width + margin.left + margin.right} ${height + margin.top + margin.bottom}`)
    .style('max-width', '100%')
    .style('height', 'auto')
    .append('g')
    .attr('transform', `translate(${margin.left},${margin.top})`);

  // Scales
  xScale = d3.scaleLinear()
    .domain(d3.extent(budgetData, d => d.year))
    .range([0, width]);

  yScale = d3.scaleLinear()
    .domain([0, d3.max(budgetData, d => Math.max(d.revenue, d.expenses)) * 1.1])
    .range([height, 0]);

  // Line generators
  const revenueLine = d3.line()
    .x(d => xScale(d.year))
    .y(d => yScale(d.revenue))
    .curve(d3.curveMonotoneX);

  const expenseLine = d3.line()
    .x(d => xScale(d.year))
    .y(d => yScale(d.expenses))
    .curve(d3.curveMonotoneX);

  // Add grid lines first (so they appear behind everything)
  svg.append('g')
    .attr('class', 'grid')
    .attr('transform', `translate(0,${height})`)
    .call(d3.axisBottom(xScale)
      .tickSize(-height)
      .tickFormat('')
      .ticks(Math.min(10, Math.floor(width / 80)))
    )
    .style('stroke-dasharray', '3,3')
    .style('opacity', 0.3);

  svg.append('g')
    .attr('class', 'grid')
    .call(d3.axisLeft(yScale)
      .tickSize(-width)
      .tickFormat('')
      .ticks(Math.min(8, Math.floor(height / 40)))
    )
    .style('stroke-dasharray', '3,3')
    .style('opacity', 0.3);

  // Add axes
  svg.append('g')
    .attr('transform', `translate(0,${height})`)
    .call(d3.axisBottom(xScale)
      .tickFormat(d3.format('d'))
      .ticks(Math.min(10, Math.floor(width / 80)))
    )
    .append('text')
    .attr('x', width / 2)
    .attr('y', 40)
    .style('text-anchor', 'middle')
    .style('fill', 'black')
    .style('font-size', window.innerWidth > 768 ? '12px' : '10px')
    .text('Year');

  svg.append('g')
    .call(d3.axisLeft(yScale).ticks(Math.min(8, Math.floor(height / 40))))
    .append('text')
    .attr('transform', 'rotate(-90)')
    .attr('y', window.innerWidth > 768 ? -60 : -45)
    .attr('x', -height / 2)
    .style('text-anchor', 'middle')
    .style('fill', 'black')
    .style('font-size', window.innerWidth > 768 ? '12px' : '10px')
    .text('Amount (Millions $)');

  // Add revenue line
  svg.append('path')
    .datum(budgetData)
    .attr('fill', 'none')
    .attr('stroke', '#10b981')
    .attr('stroke-width', window.innerWidth > 768 ? 3 : 2)
    .attr('d', revenueLine);

  // Add expense line
  svg.append('path')
    .datum(budgetData)
    .attr('fill', 'none')
    .attr('stroke', '#ef4444')
    .attr('stroke-width', window.innerWidth > 768 ? 3 : 2)
    .attr('d', expenseLine);

  // Add revenue points
  svg.selectAll('.revenue-point')
    .data(budgetData)
    .enter()
    .append('circle')
    .attr('class', 'revenue-point')
    .attr('cx', d => xScale(d.year))
    .attr('cy', d => yScale(d.revenue))
    .attr('r', window.innerWidth > 768 ? 4 : 3)
    .attr('fill', '#10b981')
    .style('cursor', 'pointer');

  // Add expense points
  svg.selectAll('.expense-point')
    .data(budgetData)
    .enter()
    .append('circle')
    .attr('class', 'expense-point')
    .attr('cx', d => xScale(d.year))
    .attr('cy', d => yScale(d.expenses))
    .attr('r', window.innerWidth > 768 ? 4 : 3)
    .attr('fill', '#ef4444')
    .style('cursor', 'pointer');

  // Add legend - position responsively
  const legendX = window.innerWidth > 768 ? width - 120 : 10;
  const legendY = window.innerWidth > 768 ? 20 : height - 60;
  
  legend = svg.append('g')
    .attr('transform', `translate(${legendX}, ${legendY})`);

  if (window.innerWidth <= 768) {
    // Horizontal legend for mobile
    legend.append('line')
      .attr('x1', 0)
      .attr('x2', 15)
      .attr('y1', 0)
      .attr('y2', 0)
      .attr('stroke', '#10b981')
      .attr('stroke-width', 2);

    legend.append('text')
      .attr('x', 20)
      .attr('y', 0)
      .attr('dy', '0.35em')
      .style('font-size', '10px')
      .text('Revenue');

    legend.append('line')
      .attr('x1', 80)
      .attr('x2', 95)
      .attr('y1', 0)
      .attr('y2', 0)
      .attr('stroke', '#ef4444')
      .attr('stroke-width', 2);

    legend.append('text')
      .attr('x', 100)
      .attr('y', 0)
      .attr('dy', '0.35em')
      .style('font-size', '10px')
      .text('Expenses');
  } else {
    // Vertical legend for desktop
    legend.append('line')
      .attr('x1', 0)
      .attr('x2', 20)
      .attr('y1', 0)
      .attr('y2', 0)
      .attr('stroke', '#10b981')
      .attr('stroke-width', 3);

    legend.append('text')
      .attr('x', 25)
      .attr('y', 0)
      .attr('dy', '0.35em')
      .style('font-size', '12px')
      .text('Revenue');

    legend.append('line')
      .attr('x1', 0)
      .attr('x2', 20)
      .attr('y1', 20)
      .attr('y2', 20)
      .attr('stroke', '#ef4444')
      .attr('stroke-width', 3);

    legend.append('text')
      .attr('x', 25)
      .attr('y', 20)
      .attr('dy', '0.35em')
      .style('font-size', '12px')
      .text('Expenses');
  }

  // Add tooltip
  const tooltip = d3.select('body').selectAll('.budget-tooltip').data([0]);
  const tooltipEnter = tooltip.enter().append('div')
    .attr('class', 'budget-tooltip')
    .style('opacity', 0)
    .style('position', 'absolute')
    .style('background', 'rgba(0, 0, 0, 0.9)')
    .style('color', 'white')
    .style('padding', '10px')
    .style('border-radius', '6px')
    .style('font-size', '12px')
    .style('pointer-events', 'none')
    .style('box-shadow', '0 4px 6px rgba(0, 0, 0, 0.1)')
    .style('z-index', '100');

  const tooltipMerged = tooltipEnter.merge(tooltip);

  // Add hover interactions
  svg.selectAll('.revenue-point, .expense-point')
    .on('mouseover', function(event, d) {
      const type = d3.select(this).attr('class').includes('revenue') ? 'Revenue' : 'Expenses';
      const value = type === 'Revenue' ? d.revenue : d.expenses;
      const color = type === 'Revenue' ? '#10b981' : '#ef4444';
      
      d3.select(this).attr('r', window.innerWidth > 768 ? 6 : 5);
      
      tooltipMerged.transition().duration(200).style('opacity', .95);
      tooltipMerged.html(`
        <div style="font-weight: bold; color: ${color};">${type} ${d.year}</div>
        <div style="margin-top: 4px;">Amount: $${value}M</div>
        <div>Population: ${d.population.toLocaleString()}</div>
        <div style="font-size: 10px; margin-top: 4px; opacity: 0.8;">Per capita: $${Math.round((value * 1000000) / d.population)}</div>
      `)
        .style('left', Math.min(event.pageX + 10, window.innerWidth - 200) + 'px')
        .style('top', (event.pageY - 80) + 'px');
    })
    .on('mouseout', function(d) {
      d3.select(this).attr('r', window.innerWidth > 768 ? 4 : 3);
      tooltipMerged.transition().duration(500).style('opacity', 0);
    });
}

// Initial chart creation
createChart();

// Responsive resize handler
let resizeTimer;
window.addEventListener('resize', function() {
  clearTimeout(resizeTimer);
  resizeTimer = setTimeout(function() {
    createChart();
  }, 250);
});
</script>